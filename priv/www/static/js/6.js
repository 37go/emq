webpackJsonp([6],{M9ic:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("fZjL"),n=s.n(a),i=s("zL8q"),c={name:"tabs-card-head",components:{"el-badge":i.Badge},props:{tabs:{type:Array,required:!0}}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"tabs-card-head"},t._l(t.tabs,function(e,a){return s("a",{key:a,staticClass:"tab-title",class:{active:t.$route.query[e.handle.key]===e.handle.value},attrs:{href:"javascript:;"},on:{click:function(s){t.$router.push(e.path)}}},[t._v("\n    "+t._s(e.name)+"\n  ")])}))},staticRenderFns:[]};var l=s("VU/8")(c,r,!1,function(t){s("Mp5J")},null,null).exports,o={name:"tabs-head",components:{"el-row":i.Row,"el-col":i.Col,TabsCardHead:l},data:function(){return{tabs:[{name:this.$t("instances.all"),path:"/instances",handle:{key:"state",value:void 0}},{name:this.$t("instances.running"),path:"/instances?state=running",handle:{key:"state",value:"running"}},{name:this.$t("instances.stopped"),path:"/instances?state=stopped",handle:{key:"state",value:"stopped"}}]}}},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-row",{attrs:{type:"flex",justify:"space-between",align:"middle"}},[e("el-col",[e("tabs-card-head",{attrs:{tabs:this.tabs}})],1)],1)},staticRenderFns:[]},u={name:"instances-view",components:{TabsHead:s("VU/8")(o,d,!1,null,null,null).exports},computed:{handleDescription:function(){var t=this.filterType.includes(this.$route.query.type)?this.$route.query.type:"all";return this.description[t]}},watch:{$route:"handlerFilter"},data:function(){return{state:"All",displayStyle:"card",popoverVisible:!1,stopPopover:!1,dialogVisible:!1,filterType:["auth","backend","bridge","hock"],filterState:{stopped:0,running:1},initInstance:{serviceType:"auth"},serviceName:"",currentService:{},services:{},instanceList:[],displayList:[],serviceList:{auth:[],bridge:[],backend:[],other:[]},description:{auth:this.$t("instances.authDesc"),backend:this.$t("instances.backendDesc"),bridge:this.$t("instances.bridgeDesc"),hock:this.$t("instances.hockDesc"),other:this.$t("instances.otherDesc")}}},methods:{loadData:function(){var t=this;this.$httpGet("/instances").then(function(e){t.instanceList=e.data.items,t.handlerFilter()}).catch(function(e){t.$message.error(e||t.$t("error.networkError"))})},hidePopover:function(){var t=this;this.popoverVisible=!0,setTimeout(function(){t.popoverVisible=!1},0)},loadService:function(t){var e=this;t&&(this.services[t]?this.currentService=this.services[t]:(this.currentService={},this.$httpGet("/services/"+t).then(function(s){e.services[t]=s.data,e.currentService=s.data}).catch()))},handleInstance:function(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.$message.success("等待后端完成API"):(this.hidePopover(),this.$message.success("等待后端完成API")),this.loadData()},loadStateFromUrl:function(){this.state=n()(this.filterState).includes(this.$route.query.state)?this.$route.query.state:"All"},handlerFilter:function(){var t=this;this.displayList=this.instanceList.filter(function(e){return!n()(t.filterState).includes(t.$route.query.state)||e.status===t.filterState[t.$route.query.state]})},handleService:function(){var t=this;this.dialogVisible=!0,this.$httpGet("/services").then(function(e){e.data.items.forEach(function(e){t.filterType.includes(e.type)?t.serviceList[e.type].push(e):t.serviceList.other.push(e)})}).catch()}},created:function(){this.loadData(),this.loadStateFromUrl()}},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"instances-view"},[s("div",{staticClass:"page-title"},[t._v("\n    "+t._s(t.$t("instances.instances"))+"\n    "),s("el-button",{staticClass:"confirm-btn",staticStyle:{float:"right"},attrs:{round:"",plain:"",type:"success",icon:"el-icon-plus",size:"medium",disable:t.$store.state.loading},on:{click:t.handleService}},[t._v("\n      "+t._s(t.$t("instances.createInstance"))+"\n    ")])],1),t._v(" "),s("tabs-head"),t._v(" "),s("div",{staticClass:"instances-list"},[s("el-row",{attrs:{gutter:20}},t._l(t.displayList,function(e,a){return s("el-col",{key:a,class:["instance-card",1===e.status?"running":"stopped"],attrs:{xs:24,sm:12,lg:8,xl:4}},[s("el-card",{staticClass:"el-card--self",nativeOn:{click:function(s){t.$router.push("/instances/"+e.id)}}},[s("div",{staticClass:"instance-card-top"},[s("div",{staticClass:"instance-card-icon"},["auth"===e.type?s("i",{staticClass:"fa fa-lock",attrs:{"aria-hidden":"true"}}):"backend"===e.type?s("i",{staticClass:"fa fa-floppy-o",attrs:{"aria-hidden":"true"}}):"bridge"===e.type?s("i",{staticClass:"fa fa-expand",attrs:{"aria-hidden":"true"}}):"hock"===e.type?s("i",{staticClass:"fa fa-toggle-off",attrs:{"aria-hidden":"true"}}):s("i",{staticClass:"fa fa-plug",attrs:{"aria-hidden":"true"}})]),t._v(" "),s("div",{staticClass:"instance-card-name"},[s("h3",[t._v(t._s(e.name))])])]),t._v(" "),s("div",{staticClass:"instance-card-details"},[s("p",[t._v(t._s(e.descr))]),t._v(" "),s("el-popover",{attrs:{placement:"top",width:"200",trigger:"hover",title:e.service,"open-delay":100},on:{show:function(s){t.loadService(e.service)}}},[s("div",{staticClass:"instances-service-details",staticStyle:{"min-height":"50px"}},[t.currentService.name?s("div",[s("p",{staticClass:"desc--text"},[t._v(t._s(t.currentService.descr))]),t._v(" "),s("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.instances.running)+" "+t._s(t.$t("instances.running"))+"\n                  ")]),t._v(" "),s("el-tag",{attrs:{type:"danger",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.instances.stopped)+" "+t._s(t.$t("instances.stopped"))+"\n                  ")]),t._v(" "),s("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("\n                    "+t._s(t.currentService.type)+"\n                  ")])],1):t._e()]),t._v(" "),s("el-tag",{attrs:{slot:"reference",type:"info",size:"mini"},slot:"reference"},[t._v("\n                "+t._s(e.service)+"\n              ")])],1)],1),t._v(" "),s("div",{staticClass:"instance-card-footer clear-fix"},[1===e.status?s("div",{staticClass:"instance-instance-status"},[s("el-tag",{attrs:{type:"success",size:"mini"}},[t._v("\n                "+t._s(t._f("howLong")(e.createAt))+"\n              ")])],1):s("div",{staticClass:"instance-instance-status"},[s("el-tag",{attrs:{type:"info",size:"mini"}},[t._v("\n                "+t._s(t.$t("instances.stopped"))+"\n              ")])],1),t._v(" "),s("div",{staticClass:"instance-active-btn"},[1===e.status?s("div",{staticClass:"stop-area"},[s("el-popover",{attrs:{placement:"left",value:t.popoverVisible}},[s("p",[t._v(t._s(t.$t("oper.confirmStop")))]),t._v(" "),s("div",{staticStyle:{"text-align":"right",margin:"0"}},[s("el-button",{staticClass:"cache-btn",attrs:{type:"text",size:"mini"},on:{click:t.hidePopover}},[t._v("\n                      "+t._s(t.$t("oper.cancel"))+"\n                    ")]),t._v(" "),s("el-button",{attrs:{type:"success",size:"mini"},nativeOn:{click:function(e){t.handleInstance(!1)}}},[t._v("\n                      "+t._s(t.$t("oper.confirm"))+"\n                    ")])],1),t._v(" "),s("el-button",{attrs:{slot:"reference",type:"danger",size:"mini"},on:{click:function(t){t.stopPropagation()}},slot:"reference"},[t._v("\n                    "+t._s(t.$t("oper.stop"))+"\n                  ")])],1)],1):s("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return e.stopPropagation(),t.handleInstance(e)}}},[t._v("\n                $t('oper.start')\n              ")])],1)])])],1)}))],1),t._v(" "),s("el-dialog",{staticClass:"service-list",attrs:{width:"500px",title:t.$t("instances.selectServiceType"),visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-tabs",{model:{value:t.initInstance.serviceType,callback:function(e){t.$set(t.initInstance,"serviceType",e)},expression:"initInstance.serviceType"}},[s("el-tab-pane",{attrs:{name:"auth",label:t.$t("instances.auth")}},[t._v("\n        "+t._s(t.description.auth)+"\n        "),s("div",{staticClass:"service-card"},[s("el-table",{staticClass:"el-table--public",attrs:{data:t.serviceList.auth}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.serviceName!==e.row.name?s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){t.serviceName=e.row.name}}},[t._v("\n                  "+t._s(t.$t("instances.select"))+"\n                ")]):t._e(),t._v(" "),t.serviceName===e.row.name?s("el-button",{staticStyle:{display:"block"},attrs:{type:"danger",size:"small"},on:{click:function(e){t.serviceName=""}}},[t._v("\n                  "+t._s(t.$t("instances.selected"))+"\n                ")]):t._e()]}}])})],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{name:"backend",label:t.$t("instances.backend")}},[t._v("\n        "+t._s(t.description.backend)+"\n        "),s("div",{staticClass:"service-card"},[s("el-table",{staticClass:"el-table--public",attrs:{data:t.serviceList.backend}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.serviceName!==e.row.name?s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){t.serviceName=e.row.name}}},[t._v("\n                  "+t._s(t.$t("instances.select"))+"\n                ")]):t._e(),t._v(" "),t.serviceName===e.row.name?s("el-button",{staticStyle:{display:"block"},attrs:{type:"danger",size:"small"},on:{click:function(e){t.serviceName=""}}},[t._v("\n                  "+t._s(t.$t("instances.selected"))+"\n                ")]):t._e()]}}])})],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{name:"bridge",label:t.$t("instances.bridge")}},[t._v("\n        "+t._s(t.description.bridge)+"\n        "),s("div",{staticClass:"service-card"},[s("el-table",{staticClass:"el-table--public",attrs:{data:t.serviceList.bridge}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.serviceName!==e.row.name?s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){t.serviceName=e.row.name}}},[t._v("\n                  "+t._s(t.$t("instances.select"))+"\n                ")]):t._e(),t._v(" "),t.serviceName===e.row.name?s("el-button",{staticStyle:{display:"block"},attrs:{type:"danger",size:"small"},on:{click:function(e){t.serviceName=""}}},[t._v("\n                  "+t._s(t.$t("instances.selected"))+"\n                ")]):t._e()]}}])})],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{name:"hock",label:t.$t("instances.hock")}},[t._v("\n        "+t._s(t.description.hock)+"\n        "),s("div",{staticClass:"service-card"},[s("el-table",{staticClass:"el-table--public",attrs:{data:t.serviceList.hock}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.serviceName!==e.row.name?s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){t.serviceName=e.row.name}}},[t._v("\n                  "+t._s(t.$t("instances.select"))+"\n                ")]):t._e(),t._v(" "),t.serviceName===e.row.name?s("el-button",{staticStyle:{display:"block"},attrs:{type:"danger",size:"small"},on:{click:function(e){t.serviceName=""}}},[t._v("\n                  "+t._s(t.$t("instances.selected"))+"\n                ")]):t._e()]}}])})],1)],1)]),t._v(" "),s("el-tab-pane",{attrs:{name:"other",label:t.$t("instances.other")}},[t._v("\n        "+t._s(t.description.other)+"\n        "),s("div",{staticClass:"service-card"},[s("el-table",{staticClass:"el-table--public",attrs:{data:t.serviceList.other}},[s("el-table-column",{attrs:{prop:"name","min-width":"200px"}}),t._v(" "),s("el-table-column",{attrs:{prop:"descr","min-width":"160px"}}),t._v(" "),s("el-table-column",{attrs:{"min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.serviceName!==e.row.name?s("el-button",{attrs:{type:"success",size:"small"},on:{click:function(s){t.serviceName=e.row.name}}},[t._v("\n                  "+t._s(t.$t("instances.select"))+"\n                ")]):t._e(),t._v(" "),t.serviceName===e.row.name?s("el-button",{staticStyle:{display:"block"},attrs:{type:"danger",size:"small"},on:{click:function(e){t.serviceName=""}}},[t._v("\n                  "+t._s(t.$t("instances.selected"))+"\n                ")]):t._e()]}}])})],1)],1)])],1),t._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("el-button",{staticClass:"confirm-btn",attrs:{type:"success",size:"small",disabled:!t.serviceName},on:{click:function(e){t.$router.push("/instances/"+t.serviceName+"/create")}}},[t._v("\n        "+t._s(t.$t("instances.nextStep"))+"\n      ")])],1)],1)],1)},staticRenderFns:[]};var v=s("VU/8")(u,p,!1,function(t){s("j0iI")},null,null);e.default=v.exports},Mp5J:function(t,e){},j0iI:function(t,e){}});