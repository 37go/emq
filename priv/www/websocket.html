<!DOCTYPE HTML>
<html lang="en-US">
<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<title>Overview - Emqttd Dashboard</title>
	<!--[if lt IE 9]>
		<script src="http://css3-mediaqueries-js.googlecode.com/svn/trunk/css3-mediaqueries.js"></script>
		<script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<script src="Javascript/Flot/excanvas.js"></script>
	<![endif]-->
	<!-- The Fonts -->
	<link href="http://fonts.googleapis.com/css?family=Oswald|Droid+Sans:400,700" rel="stylesheet" />
	<!-- The Main CSS File -->
	<link rel="stylesheet" href="res/css/style.css" />
	<!-- jQuery -->
	<script src="res/javascript/jQuery/jquery-1.7.2.min.js"></script>
	<!-- jQuryUI -->
	<script src="res/javascript/jQueryUI/jquery-ui-1.8.21.min.js"></script>
	<script src="res/javascript/emqttd.js"></script>
	<script src="res/javascript/mqttws31.js"></script>
	<script type="text/javascript">
	$(document).ready(function() {
		addClick();
		if (!window.WebSocket) {
			alert("WebSocket not supported by this browser.");
		}
		
		$('#connect_btn').click(function() {
			connect();
		});
		
		$('#send_btn').click(function() {
			var msg = jQuery('#message').val();
			sendMessage(msg);
		});
	});
	
	// Create a client instance
	var client = new Paho.MQTT.Client(location.hostname, 8083, "clientId");

	// set callback handlers
	client.onConnectionLost = onConnectionLost;
	client.onMessageArrived = onMessageArrived;
	
	// called when the client loses its connection
	function onConnectionLost(responseObject) {
		if (responseObject.errorCode !== 0) {
			console.log("onConnectionLost:" + responseObject.errorMessage);
		}
	}

	// called when a message arrives
	function onMessageArrived(message) {
		console.log("onMessageArrived:" + message.payloadString);
	}
	
	// the client connect
	function connect() {
		client.connect({onSuccess : function() {
			jQuery('#conn_state').text('CONNECTED');
			console.log("The client connect success.");
			client.subscribe("/World");
			var message = new Paho.MQTT.Message("Hello");
			message.destinationName = "/World";
			client.send(message);
		}});
	}
	
	// the client send message
	function sendMessage(msg) {
		var message = new Paho.MQTT.Message(msg);
		message.destinationName = "/World";
		client.send(message);
	}
	</script>
</head>
<body>
	<!-- Top Panel 
	<div class="top_panel">
		<div class="wrapper">
			<div class="user">
				<img src="res/images/user_avatar.png" alt="user_avatar" class="user_avatar" />
				<span class="label">John Alex</span>
			</div>
			<div class="top_links">
				<ul>
					<li>
						<a href="#" title="Log-Out" style="padding-left: 0px;">
							<span class="label">Log-Out</span>
						</a>
					</li>
					<li class="i_22_settings">
						<a href="#" title="Settings">
							<span class="label">Settings</span>
						</a>
					</li>
				</ul>
			</div>
		</div>
	</div>
	-->

	<header class="main_header">
		<div class="wrapper">
			<div class="logo">
				<a href="#" title="Emqtt Home">
					<img src="res/images/emqtt_logo.png" alt="emqtt_logo" />
				</a>
			</div>
			<!-- <nav class="top_buttons"></nav> -->
		</div>
	</header>

	<div class="wrapper contents_wrapper">
		
		<aside class="sidebar">
			<ul class="tab_nav" id="tab_nav">
				<li class="">
					<a href="#" title="General Info">
						<span class="tab_label">Overview</span>
						<span class="tab_info">General Info</span>
					</a>
				</li>
				<li class="">
					<a href="#" title="Clients Message">
						<span class="tab_label">Clients</span>
						<span class="tab_info">Clients Messages</span>
					</a>
				</li>
				<li class="">
					<a href="#" title="Session Data">
						<span class="tab_label">Session</span>
						<span class="tab_info">Session Data</span>
					</a>
				</li>
				<li class="">
					<a href="#" title="Topic Messages">
						<span class="tab_label">Topic</span>
						<span class="tab_info">Topic Messages</span>
					</a>
				</li>
				<li class="">
					<a href="#" title="Subpub Messages">
						<span class="tab_label">Subpub</span>
						<span class="tab_info">Subpub Info</span>
					</a>
				</li>
				<li class="active_tab">
					<a href="websocket.html" title="Websocket">
						<span class="tab_label">Websocket</span>
						<span class="tab_info">Websocket</span>
					</a>
				</li>
			</ul>
		</aside>

		<div class="contents" id="contents">
		<div class="grid_wrapper">
		
			<div class="g_6 contents_header">
				<h3 class="i_16_dashboard tab_label">MQTT Over websocket</h3>
				<div>
					<span class="label">websocket</span>
				</div>
			</div>
		
			<!-- Separator -->
			<div class="g_12 separator">
				<span></span>
			</div>
		
			<!-- Simple Table -->
			<div class="g_12">
				<div class="widget_header">
					<h4 class="widget_header_title wwIcon i_16_tables">Connect State</h4>
				</div>
				<div class="widget_contents noPadding">
					<div class="line_grid">
						<div class="g_6">
							<label class="label">Current State: <span id="conn_state">DISCONNECT</span></label>
						</div>
						<div class="g_6">
							<div class="simple_buttons">
								<div id="connect_btn">Connect</div>
							</div>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			</div>
		
			<!-- Simple Table -->
			<div class="g_12">
				<div class="widget_header">
					<h4 class="widget_header_title wwIcon i_16_tables">Send Message</h4>
				</div>
				<div class="widget_contents noPadding">
					<div class="line_grid">
						<div class="g_6">
							<input type="text" name="message" id="message"/>
						</div>
						<div class="g_6">
							<div class="simple_buttons">
								<div id="send_btn">Send</div>
							</div>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			</div>
		</div>
		</div>

	</div>

	<footer>
		<div class="wrapper">
			<span class="copyright">
				&copy; Copyright &copy; 2015.Company <a target="_blank" href="http://emqtt.io">emqtt.io</a> All rights reserved.
			</span>
		</div>
	</footer>
</body>
</html>